#The goal of this program is be able to take in a single command line arguemnt, an url (and in the future, an IP address), and do basic investigation on the IP leveraging nmap, IPinfo.io's API, and various other bits and pieces to give a basic overview of who is the IP as well as what ports are accessible (and in the future, the services running on those p0rts). 

import requests
import nmap
import sys
import socket
import json

target=str(sys.argv[1])
scan_v = nmap.PortScanner()
ports = [21,22,23,80, 137, 139, 443, 445, 8089, 8080] #I ask you yet again, what popular piece of software runs on port 8089?
r = requests.get("https://"+target)

gethostby_ = socket.gethostbyname(sys.argv[1])
req_two = requests.get("https://ipinfo.io/"+gethostby_+"/json")
resp_= json.loads(req_two.text)
print("======Basic Information about: "+target)
print("IP Addresss: "+resp_['ip'])
print("Hostname: "+resp_['hostname'])
print('Organization: '+resp_['org'])
print("Location: "+resp_['loc'])
print("Region: "+resp_['region'])
print("City: "+resp_['city'])
print("Country: "+resp_['country'])
print("Timezone: "+resp_['timezone'])

print("Open Ports (and in the future, services) for: "+target)

print("Scanning",target,"on ports 21, 22, 80, 137, 139, 443, 445, 8080, 8089")
for port in ports:
    portscan = scan_v.scan(resp_['ip'],str(port))
    print("Port " , port, "is ", portscan['scan'][resp_['ip']]['tcp'][port]['state'])

print("Host",target," is ",portscan['scan'][resp_['ip']]['status']['state'])